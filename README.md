# Онлайн библиотека песен 
## Описание проекта

Данный сервис предоставляет API для управления онлайн библиотекой песен. В рамках проекта реализованы следующие возможности:

- Получение списка песен с фильтрацией по полям и пагинацией.
- Получение текста песни с постраничным выводом куплетов.
- Удаление песни из библиотеки.
- Изменение данных о песне.
- Добавление новой песни и обращение к внешнему API для обогащения информации о песне.

## Функциональные возможности
       
1. **REST API методы**:
   - **GET    /song/{id}**      - Получение песни по id.
   - **GET    /song/name**      - Получение песни по названию.
   - **GET    /song/all**       - Получение списка песен с фильтрацией по всем полям и поддержкой пагинации.
   - **GET    /song/{id}/text** - Получение текста песни по id с поддержкой пагинации по куплетам      
   - **GET    /song/name/text** - Получение текста песни по названию с поддержкой пагинации по куплетам
   - **POST   /song/create**    - Добавление новой песни     
   - **PUT    /song/{id}**      - Обновление информации о песне по id
   - **PATCH  /song/{id}**      - Обновление информации о песне по id (частично)
   - **DELETE /song/{id}**      - Удаление песни по id.

2. **Интеграция с внешним API**:
   При добавлении новой песни сервис отправляет запрос в API (описанный Swagger) для получения дополнительной информации о песне (дата релиза, текст песни и ссылка на видео), после чего обогащенные данные сохраняются в базе данных.

3. **Работа с базой данных**:
   Все данные о песнях хранятся в базе данных PostgreSQL. Структура таблиц создается при помощи миграций при старте сервиса.

4. **Логирование**:
   Код покрыт debug- и info-логами для упрощения отладки и отслеживания работы сервиса.

5. **Конфигурация**:
   Конфигурационные данные выведены в `local.yaml` файл.

## Требования

- **Go** >= 1.19
- **PostgreSQL** для хранения данных
- **Migrate** для миграции базы данных
- **Swagger** для генерации документации API

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/username/EffectiveMobileTest.git


2. Перейдите в директорию проекта:
   ```bash
   cd EffectiveMobileTest
   ```

3. Установите зависимости:
   ```bash
   go mod tidy
   ```

4. Настройте `local.yaml` файл с необходимыми переменными окружения, такими как настройки для подключения к базе данных.
 
5. Скомпилируйте и запустите проект:
   ```bash
   go run cmd/song-lib/main.go
   ```

## API Документация

API спецификация доступна через Swagger. Для генерации документации выполните команду:
```bash
  swag init --generalInfo cmd/song-lib/main.go --output cmd/song-lib/docs 
```
После этого документация будет доступна по адресу `/swagger/index.html`.

## Структура проекта

```bash
.
├── cmd
│   └── song-lib           # Точка входа приложения
├── config                 # Файлы конфигурации
├── internal
│   ├── app                # Инициализация приложения
│   │   └── http
│   ├── client             # Клиент для обращения к стороннему API
│   │   └── song
│   ├── config             # Конфигурация сервиса
│   ├── domain
│   │   └── models         # Модели данных
│   ├── http-server        # HTTP сервер и обработчики запросов
│   │   └── song
│   ├── migrator           # Утилита для запуска миграций 
│   ├── services           # Логика приложения
│   │   └── song
│   ├── storage            # Доступ к данным PostgreSQL
│   │   └── postgres        
│   └── utils              # Утилиты и вспомогательные функции
├── migrations             # SQL миграции для создания структуры БД
└── go.mod                 # Зависимости Go
```

## Переменные окружения

Необходимо указать параметр:

- `CONFIG_PATH` — Путь к конфигурационному файлу.
